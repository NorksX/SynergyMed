<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>SynergyMed – Branded Medicines</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Header styles (fragment from templates/fragments/header.html) -->
    <th:block th:replace="fragments/header :: headerStyles"></th:block>

    <!-- Page styles -->
    <style>
        :root{
            --teal-1:#20b2aa; --teal-2:#48d1cc; --bg:#fefeff; --card:#ffffff;
            --muted:#6c757d; --text:#1f2937;
            --shadow:0 20px 40px rgba(0,0,0,0.10);
            --shadow-sm:0 6px 18px rgba(0,0,0,0.08);
        }
        *{margin:0;padding:0;box-sizing:border-box}

        /* Make the header edge-to-edge at the very top, and stack content under it */
        body{
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            min-height:100vh;
            background:linear-gradient(135deg,#a4ecba 0%,#fefeff 100%);
            color:var(--text);
            display:flex;
            flex-direction:column;   /* stack header and page vertically */
            align-items:center;      /* center the .page container */
            /* no body padding so header touches the edges */
        }

        /* Centered content container with interior padding (replacing old body padding) */
        .page{
            width:100%;
            max-width:1200px;
            padding:28px;           /* replaces previous body padding */
            margin:0 auto;
        }

        /* Force the global site header to be full-width, square corners, top-attached */
        .site-header{
            position: sticky;
            top:0;
            left:0;
            right:0;
            width:100%;
            border-radius:0;
            margin:0;
            z-index:1000;
            background:white !important; /* Force white background */
            box-shadow:0 2px 10px rgba(0,0,0,0.1); /* Add subtle shadow */
        }

        /* Optional: space between global header and the page section header */
        .after-site-header{ height: 16px; }

        /* Page section header (title + create button) */
        .header{
            display:flex;justify-content:space-between;align-items:center;
            margin-bottom:24px;
            background:linear-gradient(135deg,var(--teal-1),var(--teal-2));
            color:#fff;padding:20px 24px;border-radius:20px;box-shadow:var(--shadow);
        }

        .btn{display:inline-block;border:none;cursor:pointer;text-decoration:none;
            padding:12px 16px;border-radius:12px;font-weight:600;letter-spacing:.5px;transition:.2s ease}
        .btn-primary{background:linear-gradient(135deg,var(--teal-1),var(--teal-2));color:#fff;box-shadow:0 10px 20px rgba(32,178,170,.25)}
        .btn-primary:hover{transform:translateY(-2px)}

        .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:22px}
        .card{background:var(--card);border-radius:18px;overflow:hidden;box-shadow:var(--shadow-sm);display:flex;flex-direction:column}
        .thumb{width:100%;height:240px;object-fit:cover;background:#eef2f3;display:block}
        .content{padding:14px 16px 18px}
        .title{font-weight:700;margin:6px 0 2px}
        .muted{color:var(--muted);font-size:.92rem}
        .row{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
        .price{font-weight:800}
        .btn-outline{background:#fff;border:2px solid rgba(32,178,170,.25);color:#20b2aa;padding:8px 12px;border-radius:10px;text-decoration:none;font-weight:600;transition:.2s ease}
        .btn-outline:hover{border-color:#20b2aa;box-shadow:0 6px 14px rgba(32,178,170,.18)}

        @media (max-width:560px){
            .page{padding:16px}
            .header{padding:16px}
        }
    </style>
</head>
<body>

<!-- Full-width, top-attached global header -->
<th:block th:replace="fragments/header :: siteHeader('medicines', ${username})"></th:block>

<!-- small spacer below the global header (optional) -->
<div class="after-site-header" aria-hidden="true"></div>

<!-- Centered page content -->
<div class="page">
    <div class="header">
        <h2>Branded Medicines</h2>
        <a class="btn btn-primary" th:href="@{/branded-medicines/new}">Create</a>
    </div>

    <div class="grid">
        <div class="card" th:each="bm : ${medicines}">
            <img class="thumb" th:src="@{${firstImageById[bm.id]}}" alt="product image">
            <div class="content">
                <div class="title" th:text="${bm.name}">Name</div>
                <div class="muted" th:text="${bm.dosageForm}">Dosage Form</div>
                <div class="row">
                    <div class="price" th:text="${#numbers.formatDecimal(bm.price, 1, 'COMMA', 2, 'POINT') + ' ден.'}">0.00 ден.</div>
                    <div>
                        <form th:action="@{/branded-medicines/{id}/delete(id=${bm.id})}" method="post" style="display:inline">
                            <button type="submit" class="btn-outline" style="margin-right:8px;color:#b3261e;border-color:#f0caca">Delete</button>
                        </form>
                        <a class="btn-outline" th:href="@{/branded-medicines/{id}/edit(id=${bm.id})}">Edit</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Header dropdown script -->
<th:block th:replace="fragments/header :: headerScripts"></th:block>
</body>
</html>
