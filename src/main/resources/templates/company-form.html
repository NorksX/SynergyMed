<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title th:text="${mode=='create' ? 'Create Company' : 'Edit Company'}">Company</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root{--teal-1:#20b2aa;--teal-2:#48d1cc;--bg:#fefeff;--card:#ffffff;--muted:#6c757d;--shadow:0 20px 40px rgba(0,0,0,.1)}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#a4ecba 0%,#fefeff 100%);padding:24px}
        .wrap{width:100%;max-width:720px;background:#fff;border-radius:20px;overflow:hidden;box-shadow:var(--shadow)}
        .head{background:linear-gradient(135deg,var(--teal-1),var(--teal-2));color:#fff;padding:26px 24px}
        .body{padding:26px 24px}
        .row{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
        .row-1{display:grid;grid-template-columns:1fr;gap:16px;margin-bottom:6px}
        label{display:block;margin-bottom:8px;color:#334155;font-weight:600;font-size:.95rem}
        input,textarea{width:100%;padding:14px 12px;border:2px solid #e6ebf0;border-radius:12px;background:#f8fafc;transition:.2s ease;font-size:1rem}
        textarea{min-height:110px}
        input:focus,textarea:focus{outline:none;border-color:var(--teal-1);background:#fff;box-shadow:0 0 0 3px rgba(32,178,170,.12)}
        .hint{color:var(--muted);font-size:.86rem;margin-top:4px}
        .roles{display:flex;flex-wrap:wrap;gap:10px;margin-top:6px}
        .chip{display:inline-flex;align-items:center;gap:6px;border:2px solid rgba(32,178,170,.25);border-radius:999px;padding:8px 12px;background:#fff}
        .actions{display:flex;gap:12px;padding:0 24px 24px 24px}
        .btn{border:none;padding:12px 16px;border-radius:12px;cursor:pointer;font-weight:700;letter-spacing:.4px}
        .btn-primary{background:linear-gradient(135deg,var(--teal-1),var(--teal-2));color:#fff;box-shadow:0 10px 20px rgba(32,178,170,.25)}
        .btn-secondary{background:#fff;color:#111;border:2px solid rgba(32,178,170,.25)}
    </style>
</head>
<body>
<div class="wrap">
    <div class="head">
        <h2 th:text="${mode=='create' ? 'Create Company' : 'Edit Company'}">Company</h2>
    </div>

    <div class="body">
        <form th:action="${mode=='create'} ? @{/companies} : @{/companies/{id}/update(id=${company.id})}" method="post">
            <!-- If Spring Security is enabled, include a CSRF token input here -->

            <div class="row">
                <div>
                    <label>Company Name</label>
                    <input type="text" name="companyName" th:value="${mode=='edit' ? company.companyName : ''}" required>
                </div>
                <div>
                    <label>Registration Number</label>
                    <input type="text" name="registrationNumber" th:value="${mode=='edit' ? company.registrationNumber : ''}" required>
                </div>
            </div>

            <div class="row-1">
                <div>
                    <label>Description</label>
                    <textarea name="description" th:text="${mode=='edit' ? company.description : ''}"></textarea>
                </div>
            </div>

            <!-- Roles on both create and edit; edit pre-checks via selectedRoles -->
            <div class="row-1">
                <div>
                    <label>Company Types</label>
                    <div class="roles">
                        <label class="chip" th:each="rt : ${roleTypes}">
                            <input type="checkbox" name="roles" th:value="${rt}"
                                   th:checked="${mode=='edit' and selectedRoles != null and selectedRoles.contains(rt)}">
                            <span th:text="${rt}">ROLE</span>
                        </label>
                    </div>
                    <div class="hint">Select roles; on update, existing roles are pre-checked based on current state.</div>
                </div>
            </div>

            <div class="actions">
                <button class="btn btn-primary" type="submit" th:text="${mode=='create' ? 'Create' : 'Update'}">Save</button>
                <a class="btn btn-secondary" th:href="@{/companies}">Cancel</a>
            </div>
        </form>
    </div>
</div>
</body>
</html>
